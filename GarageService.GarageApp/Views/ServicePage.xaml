<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="GarageService.GarageApp.Views.ServicePage"
             xmlns:views="clr-namespace:GarageService.GarageApp.Views"
             Title="ServicePage">
    <Grid RowDefinitions="Auto,*">
        <!-- TitleView in first row -->
        <views:TitleView Title="Add Service"
                       SubmitCommand="{Binding SaveCommand}"
                       BackCommand="{Binding GoBack}"
                       Grid.Row="0"/>

        <!-- Scrollable content in second row -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Padding="20" Spacing="25">

                <!-- Form Section -->
                <VerticalStackLayout Spacing="15">
                    <!-- Date Field -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Date" 
                             FontSize="14"
                             TextColor="{StaticResource Gray600}"/>
                        <DatePicker Date="{Binding ServiceDate}"
                                  BackgroundColor="White"
                                  TextColor="{StaticResource Gray900}"/>
                    </VerticalStackLayout>

                    <!-- Odometer Field -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Odometer" 
                             FontSize="14"
                             TextColor="{StaticResource Gray600}"/>
                        <Entry Text="{Binding Odometer}" 
                             Keyboard="Numeric"
                             BackgroundColor="White"
                             TextColor="{StaticResource Gray900}"
                             Placeholder="Enter odometer reading"/>
                    </VerticalStackLayout>

                   

                    <!-- Notes Field -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Notes" 
                             FontSize="14"
                             TextColor="{StaticResource Gray600}"/>
                        <Editor Text="{Binding Notes}" 
                              HeightRequest="100"
                              BackgroundColor="White"
                              TextColor="{StaticResource Gray900}"
                              AutoSize="TextChanges"
                              Placeholder="Enter any additional notes"/>
                    </VerticalStackLayout>
                </VerticalStackLayout>

                <!-- Service Types Section -->
                <VerticalStackLayout Spacing="15">
                    <Label Text="Service Types" 
                         FontSize="20" 
                         FontAttributes="Bold"
                         TextColor="{StaticResource Primary}"/>

                    <CollectionView ItemsSource="{Binding ServiceTypess}"
                                 SelectionMode="None"
                                 ItemsUpdatingScrollMode="KeepScrollOffset">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="15"
                                     Margin="0,0,0,10"
                                     BackgroundColor="White"
                                     StrokeShape="RoundRectangle 10"
                                     Stroke="Transparent">
                                    <Border.Shadow>
                                        <Shadow Brush="Black" Offset="0,2" Radius="6" Opacity="0.1"/>
                                    </Border.Shadow>
                                    <Grid ColumnDefinitions="Auto,*,Auto,*,Auto,*" ColumnSpacing="8">
                                        <Label Text="Type:" 
                                             FontAttributes="Bold"
                                             Grid.Column="0"/>
                                        <Label Text="{Binding Description}"
                                             Grid.Column="1"/>

                                        <Label Text="Cost:" 
                                             FontAttributes="Bold"
                                             Grid.Column="2"/>
                                        <Label Text="{Binding Cost, StringFormat='{0:C}'}"
                                             Grid.Column="3"/>

                                        <Label Text="Currency:" 
                                             FontAttributes="Bold"
                                             Grid.Column="4"/>
                                        <Label Text="{Binding CurrDesc}"
                                             Grid.Column="5"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <Label Grid.Row="2" Grid.Column="1"
                    FontSize="16"
                    FontFamily="Regular"
                    
                    TextColor="{AppThemeBinding Light=#64748B, Dark=#A1A1AA}">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="+" FontAttributes="Bold"/>
                                <Span Text=" "/>
                                <Span Text="Add Service Type"/>
                            </FormattedString>
                        </Label.FormattedText>
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding AddServiceTypeCommand}" />
                        </Label.GestureRecognizers>
                    </Label>
                    <Label Grid.Row="3" Grid.Column="1"
                        Text="{Binding TotalServiceAmount, StringFormat='Total: {0:C}'}"
                        FontSize="18"
                        FontAttributes="Bold"
                        TextColor="{StaticResource Primary}"
                        HorizontalOptions="End"
                        Margin="0,10,0,0"/>
                </VerticalStackLayout>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>